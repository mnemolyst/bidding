mixin contest(contest)
    if contest === null
        .contest.new
            a(href="javascript:void(null)") new
    else
        .contest(data-contest-id=contest._id.toString(), data-priority=contest.priority)
            .controls
                a.tote(href="/contest/#{contest._id.toString()}/tote") Tote Board
                br
                a.delete(href="javascript:void(null)") Delete
                br
                a.move(href="javascript:void(null)") Move
            b Vig:&nbsp;
            input.vig(value=contest.vig)
            br
            br
            b New contestant:&nbsp;
            input.new-contestant(placeholder="Name")
            br
            br
            b Delete contestant:&nbsp;
            img(class="delete" src="/delete-box.png")
            table.brackets
                tr
                    each bracket in contest.brackets
                        td
                            +bracket(bracket)
            table.bids
                tr
                    each bids, type in contest.bids
                        th= type
                tr
                    each bidType in contest.bids
                        +bidType(bidType)

mixin bracket(bracket)
    table.bracket
        each match in bracket
            +match(match)
        +match()

mixin match(match)
    tr.match(class=(match ? '' : 'prototype'))
        td.contestants
            .contestant
                if match && match.contestants.length > 0
                    .name(class=(match.contestants[0] == match.winner ? 'winner' : ''))= match.contestants[0]
            img(src="/vs.png")
            .contestant
                if match && match.contestants.length > 1
                    .name(class=(match.contestants[1] == match.winner ? 'winner' : ''))= match.contestants[1]
        td.handle

mixin bidType(bidType)
    td
        each bid in bidType
            .bid #{bid.bidder}&nbsp;:&nbsp;$#{bid.amount}&nbsp;on&nbsp;#{bid.on}
        a.new-bid(href="javascript:void(null)") new
